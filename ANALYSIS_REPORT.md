# Анализ проекта: Интерактивный симулятор распределительной сети IEEE 123

## 1. Общее описание

Проект представляет собой комплексный программный инструмент для моделирования и анализа стандартной распределительной электрической сети IEEE 123. Он состоит из двух основных, но взаимосвязанных компонентов:

1.  **Интерактивный визуальный симулятор:** Графический интерфейс, позволяющий пользователям в реальном времени взаимодействовать с топологией сети, моделировать различные сценарии (включая аварийные) и анализировать их последствия.
2.  **Среда для обучения с подкреплением (Reinforcement Learning):** Модуль, предназначенный для обучения "умного" агента, способного автоматически управлять регуляторами напряжения в сети для поддержания стабильности и минимизации потерь.

**Основная технология:** В качестве расчетного ядра используется движок **OpenDSS** (через библиотеку `dss-python`), что обеспечивает высокую точность и реалистичность электротехнических расчетов.

---

## 2. Ключевые компоненты

### 2.1. Интерактивный симулятор

Этот компонент является "лицом" проекта и предназначен для ручного исследования сети.

*   **Визуализация:** С помощью `matplotlib` строится детальная карта сети IEEE 123, на которой узлы (нагрузки, регуляторы, солнечные панели) и линии электропередач отображаются разными цветами и маркерами.
*   **Интерактивность:** Пользователь может:
    *   **Моделировать аварии:** Выбирать режимы "Короткое замыкание" или "Обрыв линии", указывать фазы и кликать на узлы для создания аварий.
    *   **Анализировать QSTS (Quasi-Static Time Series):** Запускать суточный расчет профилей напряжения и тока с шагом в 15 минут.
    *   **Управлять параметрами:** Включать/выключать солнечные панели (PV), изменять температуру, день года и тестовую нагрузку через слайдеры.
*   **Анализ:** После симуляции строятся графики напряжений, токов и мощностей для выбранного узла. Также есть функция "Анализ V", которая сканирует всю сеть и подсвечивает узлы с просадками или перенапряжением.

**Основные файлы:**

*   `main.py`: Точка входа, запускающая симулятор.
*   `plot_topology.py`: "Мозг" визуализации. Отвечает за отрисовку карты, обработку кликов, управление виджетами (`matplotlib.widgets`) и вызов расчетного модуля.
*   `run_qsts_plot.py`: Расчетный модуль для симулятора. Содержит логику для:
    *   Настройки и запуска симуляции в OpenDSS.
    *   Реализации логики управления регуляторами (`GridController`).
    *   Сбора и обработки результатов для построения графиков.

### 2.2. Модуль Reinforcement Learning (RL)

Этот компонент предназначен для автоматизации управления сетью. Его цель — обучить нейросеть (агента) самостоятельно принимать решения о переключении регуляторов напряжения.

*   **Среда `gymnasium`:** Проект использует стандартную для RL библиотеку `gymnasium`. Была создана кастомная среда `IEEE123Env`, которая "оборачивает" симуляцию OpenDSS, предоставляя агенту стандартизированный интерфейс.
*   **Пространства состояний и действий:**
    *   **Состояние (Observation):** То, что "видит" агент. Это вектор данных, включающий напряжения на ключевых узлах (сенсорах), текущие положения регуляторов, общую нагрузку в сети и время суток.
    *   **Действие (Action):** То, что "делает" агент. Для каждого из регуляторов агент может выбрать одно из трех действий: `[Ничего не делать, Поднять напряжение, Понизить напряжение]`.
*   **Функция вознаграждения (Reward):** "Мотивация" агента. Он получает:
    *   **Штраф:** за выход напряжения за допустимые пределы (0.95 - 1.05 p.u.).
    *   **Штраф:** за любое отклонение от идеального напряжения (1.0 p.u.).
    *   **Штраф:** за каждое переключение регулятора (чтобы избежать износа оборудования).
*   **Обучение:** Для обучения используется популярный алгоритм **PPO** из библиотеки `stable-baselines3`.

**Основные файлы:**

*   `simulation_core.py`: Ядро симуляции, специально адаптированное для RL. Оно предоставляет "чистый" программный интерфейс для сброса среды, выполнения шага симуляции (15 минут) и получения данных о состоянии сети.
*   `gym_environment.py`: Класс `IEEE123Env`, который связывает `simulation_core` со стандартом `gymnasium`. Здесь определяются пространства состояний/действий и логика вознаграждения.
*   `train_agent.py`: Скрипт для запуска процесса обучения агента.
*   `run_trained_model.py`: Скрипт для запуска и тестирования уже обученной модели.
*   `sensors.json`: Файл конфигурации, в котором перечислены узлы сети, используемые в качестве "глаз" (сенсоров) для RL-агента.

---

## 3. Структура проекта и зависимости

*   **`qsts/`**: Директория, содержащая `.dss` файлы, которые описывают физическую модель сети IEEE 123, профили нагрузок и другие параметры для OpenDSS.
*   **`trained_models/`**: Здесь сохраняются обученные модели.
*   **`requirements.txt`**: Файл со списком всех необходимых Python-библиотек:
    *   `dss-python`: Для работы с OpenDSS.
    *   `numpy`, `pandas`: Для обработки данных.
    *   `matplotlib`: Для визуализации.
    *   `gymnasium`, `stable-baselines3`: Для обучения с подкреплением.

---

## 4. Итоговое заключение

Проект является мощным и многофункциональным инструментом для исследования электроэнергетических систем. Он успешно объединяет в себе два подхода:

1.  **Классический инженерный анализ** через интерактивный симулятор, который полезен для инженеров, исследователей и студентов.
2.  **Современный подход на основе ИИ** с использованием Reinforcement Learning для создания автономной системы управления, что является перспективным направлением в энергетике.

Код хорошо структурирован, с четким разделением на визуальную часть, расчетную логику и среду для машинного обучения.
